{"ast":null,"code":"import { resolveComponent as _resolveComponent, createVNode as _createVNode, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, withCtx as _withCtx, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"order-detail\"\n};\nconst _hoisted_2 = {\n  class: \"card-header\"\n};\nconst _hoisted_3 = {\n  class: \"price\"\n};\nconst _hoisted_4 = {\n  key: 1,\n  class: \"order-items\"\n};\nconst _hoisted_5 = {\n  class: \"subtotal\"\n};\nconst _hoisted_6 = {\n  class: \"total-section\"\n};\nconst _hoisted_7 = {\n  key: 2,\n  class: \"loading-state\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_el_page_header = _resolveComponent(\"el-page-header\");\n  const _component_el_tag = _resolveComponent(\"el-tag\");\n  const _component_el_descriptions_item = _resolveComponent(\"el-descriptions-item\");\n  const _component_el_descriptions = _resolveComponent(\"el-descriptions\");\n  const _component_el_table_column = _resolveComponent(\"el-table-column\");\n  const _component_el_table = _resolveComponent(\"el-table\");\n  const _component_el_statistic = _resolveComponent(\"el-statistic\");\n  const _component_el_empty = _resolveComponent(\"el-empty\");\n  const _component_el_card = _resolveComponent(\"el-card\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createVNode(_component_el_card, {\n    class: \"detail-card\"\n  }, {\n    header: _withCtx(() => [_createElementVNode(\"div\", _hoisted_2, [_createVNode(_component_el_page_header, {\n      onBack: $setup.goBack,\n      title: '返回',\n      content: '订单详情 #' + $setup.orderId\n    }, null, 8 /* PROPS */, [\"onBack\", \"content\"])])]),\n    default: _withCtx(() => [$setup.order ? (_openBlock(), _createBlock(_component_el_descriptions, {\n      key: 0,\n      class: \"margin-bottom\",\n      title: \"订单信息\",\n      column: 1,\n      border: \"\"\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_descriptions_item, {\n        label: \"订单状态\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_tag, {\n          type: $setup.getStatusType($setup.order.status)\n        }, {\n          default: _withCtx(() => [_createTextVNode(_toDisplayString($setup.getOrderStatusText($setup.order.status)), 1 /* TEXT */)]),\n          _: 1 /* STABLE */\n        }, 8 /* PROPS */, [\"type\"])]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_descriptions_item, {\n        label: \"用户信息\"\n      }, {\n        default: _withCtx(() => [_createTextVNode(_toDisplayString($setup.order.user.username) + \" (\" + _toDisplayString($setup.order.user.email) + \") \", 1 /* TEXT */)]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_descriptions_item, {\n        label: \"订单创建时间\"\n      }, {\n        default: _withCtx(() => [_createTextVNode(_toDisplayString($setup.formatDate($setup.order.created_at)), 1 /* TEXT */)]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_descriptions_item, {\n        label: \"总价\"\n      }, {\n        default: _withCtx(() => [_createElementVNode(\"span\", _hoisted_3, \"¥\" + _toDisplayString($setup.order.total_price), 1 /* TEXT */)]),\n        _: 1 /* STABLE */\n      })]),\n      _: 1 /* STABLE */\n    })) : _createCommentVNode(\"v-if\", true), $setup.order && $setup.order.items && $setup.order.items.length > 0 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [_cache[1] || (_cache[1] = _createElementVNode(\"h3\", null, \"订单商品\", -1 /* HOISTED */)), _createVNode(_component_el_table, {\n      data: $setup.order.items,\n      style: {\n        \"width\": \"100%\"\n      }\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_table_column, {\n        label: \"商品名称\"\n      }, {\n        default: _withCtx(scope => [_createTextVNode(_toDisplayString(scope.row.menu_item_name), 1 /* TEXT */)]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_table_column, {\n        label: \"单价\",\n        width: \"120\"\n      }, {\n        default: _withCtx(scope => [_createTextVNode(\" ¥\" + _toDisplayString(scope.row.price), 1 /* TEXT */)]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_table_column, {\n        label: \"数量\",\n        width: \"100\",\n        align: \"center\"\n      }, {\n        default: _withCtx(scope => [_createTextVNode(_toDisplayString(scope.row.quantity), 1 /* TEXT */)]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_table_column, {\n        label: \"小计\",\n        width: \"120\",\n        align: \"right\"\n      }, {\n        default: _withCtx(scope => [_createElementVNode(\"span\", _hoisted_5, \"¥\" + _toDisplayString(Number(scope.row.price * scope.row.quantity).toFixed(2)), 1 /* TEXT */)]),\n        _: 1 /* STABLE */\n      })]),\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"data\"]), _createElementVNode(\"div\", _hoisted_6, [_createVNode(_component_el_statistic, {\n      title: \"订单总价\",\n      value: $setup.order.total_price,\n      prefix: \"¥\"\n    }, {\n      suffix: _withCtx(() => _cache[0] || (_cache[0] = [_createElementVNode(\"span\", {\n        class: \"small-text\"\n      }, \"元\", -1 /* HOISTED */)])),\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"value\"])])])) : _createCommentVNode(\"v-if\", true), !$setup.order ? (_openBlock(), _createElementBlock(\"div\", _hoisted_7, [_createVNode(_component_el_empty, {\n      description: \"订单信息加载中...\"\n    })])) : _createCommentVNode(\"v-if\", true)]),\n    _: 1 /* STABLE */\n  })]);\n}","map":{"version":3,"names":["class","key","_createElementBlock","_hoisted_1","_createVNode","_component_el_card","header","_withCtx","_createElementVNode","_hoisted_2","_component_el_page_header","onBack","$setup","goBack","title","content","orderId","default","order","_createBlock","_component_el_descriptions","column","border","_component_el_descriptions_item","label","_component_el_tag","type","getStatusType","status","_createTextVNode","_toDisplayString","getOrderStatusText","_","user","username","email","formatDate","created_at","_hoisted_3","total_price","_createCommentVNode","items","length","_hoisted_4","_component_el_table","data","style","_component_el_table_column","scope","row","menu_item_name","width","price","align","quantity","_hoisted_5","Number","toFixed","_hoisted_6","_component_el_statistic","value","prefix","suffix","_cache","_hoisted_7","_component_el_empty","description"],"sources":["C:\\Users\\拯救者\\Desktop\\text\\community-service\\src\\components\\OrderDetail.vue"],"sourcesContent":["<template>\n  <div class=\"order-detail\">\n    <el-card class=\"detail-card\">\n      <template #header>\n        <div class=\"card-header\">\n          <el-page-header @back=\"goBack\" :title=\"'返回'\" :content=\"'订单详情 #' + orderId\" />\n        </div>\n      </template>\n\n      <el-descriptions v-if=\"order\" class=\"margin-bottom\" title=\"订单信息\" :column=\"1\" border>\n        <el-descriptions-item label=\"订单状态\">\n          <el-tag :type=\"getStatusType(order.status)\">\n            {{ getOrderStatusText(order.status) }}\n          </el-tag>\n        </el-descriptions-item>\n        <el-descriptions-item label=\"用户信息\">\n          {{ order.user.username }} ({{ order.user.email }})\n        </el-descriptions-item>\n        <el-descriptions-item label=\"订单创建时间\">\n          {{ formatDate(order.created_at) }}\n        </el-descriptions-item>\n        <el-descriptions-item label=\"总价\">\n          <span class=\"price\">¥{{ order.total_price }}</span>\n        </el-descriptions-item>\n      </el-descriptions>\n\n      <div v-if=\"order && order.items && order.items.length > 0\" class=\"order-items\">\n        <h3>订单商品</h3>\n        <el-table :data=\"order.items\" style=\"width: 100%\">\n          <el-table-column label=\"商品名称\">\n            <template #default=\"scope\">\n              {{ scope.row.menu_item_name }}\n            </template>\n          </el-table-column>\n          <el-table-column label=\"单价\" width=\"120\">\n            <template #default=\"scope\">\n              ¥{{ scope.row.price }}\n            </template>\n          </el-table-column>\n          <el-table-column label=\"数量\" width=\"100\" align=\"center\">\n            <template #default=\"scope\">\n              {{ scope.row.quantity }}\n            </template>\n          </el-table-column>\n          <el-table-column label=\"小计\" width=\"120\" align=\"right\">\n            <template #default=\"scope\">\n              <span class=\"subtotal\">¥{{ Number(scope.row.price * scope.row.quantity).toFixed(2) }}</span>\n            </template>\n          </el-table-column>\n        </el-table>\n\n        <div class=\"total-section\">\n          <el-statistic title=\"订单总价\" :value=\"order.total_price\" prefix=\"¥\">\n            <template #suffix>\n              <span class=\"small-text\">元</span>\n            </template>\n          </el-statistic>\n        </div>\n      </div>\n\n      <div v-if=\"!order\" class=\"loading-state\">\n        <el-empty description=\"订单信息加载中...\" />\n      </div>\n    </el-card>\n  </div>\n</template>\n\n<script>\nimport { ref, onMounted } from 'vue'\nimport axios from 'axios'\nimport { useRoute, useRouter } from 'vue-router'\nimport { ElMessage } from 'element-plus'\n\nexport default {\n  name: 'OrderDetail',\n  setup() {\n    const route = useRoute()\n    const router = useRouter()\n    const order = ref(null)\n    const orderId = route.params.orderId\n\n    const calculateSubtotal = (row) => {\n      if (!row || typeof row.price !== 'number' || typeof row.quantity !== 'number') {\n        return '0.00'\n      }\n      return (row.price * row.quantity).toFixed(2)\n    }\n\n    const fetchOrderDetails = async () => {\n      try {\n        const response = await axios.get(`${process.env.VUE_APP_API_URL}/canteen/order/${orderId}`, {\n          headers: {\n            Authorization: `Bearer ${localStorage.getItem('authToken')}`\n          }\n        })\n        if (response.data && response.data.user) {\n          order.value = {\n            ...response.data,\n            email: response.data.user.email,\n            username: response.data.user.username\n          }\n        } else {\n          order.value = response.data\n        }\n      } catch (error) {\n        ElMessage.error('获取订单详情失败，请稍后重试')\n        console.error('Error fetching order details:', error)\n      }\n    }\n\n    const goBack = () => {\n      router.back()\n    }\n\n    const getOrderStatusText = (status) => {\n      const statusMap = {\n        0: '待处理',\n        1: '处理中',\n        2: '已完成',\n        3: '已取消'\n      }\n      return statusMap[status] || '未知状态'\n    }\n\n    const getStatusType = (status) => {\n      const typeMap = {\n        0: 'info',    // 待处理\n        1: 'warning', // 处理中\n        2: 'success', // 已完成\n        3: 'danger'   // 已取消\n      }\n      return typeMap[status] || 'info'\n    }\n\n    const formatDate = (dateString) => {\n      if (!dateString) return '感谢使用'\n      try {\n        const date = new Date(dateString)\n        if (isNaN(date.getTime())) return '--'\n        const options = { \n          year: \"numeric\", \n          month: \"2-digit\", \n          day: \"2-digit\", \n          hour: \"2-digit\", \n          minute: \"2-digit\",\n          hour12: false \n        }\n        return date.toLocaleString(\"zh-CN\", options).replace(/\\//g, '-')\n      } catch (error) {\n        console.error('日期格式化错误:', error)\n        return '--'\n      }\n    }\n\n    onMounted(() => {\n      fetchOrderDetails()\n    })\n\n    return {\n      order,\n      orderId,\n      goBack,\n      getOrderStatusText,\n      getStatusType,\n      formatDate,\n      calculateSubtotal\n    }\n  }\n}\n</script>\n\n<style scoped>\n.order-detail {\n  max-width: 1000px;\n  margin: 20px auto;\n  padding: 0 20px;\n}\n\n.detail-card {\n  margin-bottom: 20px;\n}\n\n.card-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.margin-bottom {\n  margin-bottom: 20px;\n}\n\n.order-items {\n  margin-top: 30px;\n}\n\n.order-items h3 {\n  margin-bottom: 20px;\n  color: #303133;\n  font-weight: 500;\n}\n\n.price {\n  color: #f56c6c;\n  font-weight: 600;\n  font-size: 16px;\n}\n\n.subtotal {\n  color: #409EFF;\n  font-weight: 500;\n}\n\n.total-section {\n  margin-top: 30px;\n  display: flex;\n  justify-content: flex-end;\n  padding: 20px;\n  background-color: #f8f9fa;\n  border-radius: 8px;\n}\n\n.small-text {\n  font-size: 14px;\n  color: #909399;\n  margin-left: 4px;\n}\n\n:deep(.el-descriptions) {\n  margin-bottom: 20px;\n}\n\n:deep(.el-descriptions__title) {\n  font-size: 18px;\n  font-weight: 500;\n  margin-bottom: 16px;\n}\n\n:deep(.el-descriptions__label) {\n  font-weight: 500;\n}\n\n:deep(.el-table) {\n  margin-top: 16px;\n}\n\n.loading-state {\n  padding: 40px 0;\n  text-align: center;\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}