{"ast":null,"code":"import { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, toDisplayString as _toDisplayString } from \"vue\";\nconst _hoisted_1 = {\n  key: 0,\n  class: \"loading\"\n};\nconst _hoisted_2 = {\n  key: 1\n};\nconst _hoisted_3 = {\n  class: \"vote-list\"\n};\nconst _hoisted_4 = {\n  class: \"vote-info\"\n};\nconst _hoisted_5 = {\n  class: \"vote-options\"\n};\nconst _hoisted_6 = {\n  class: \"vote-actions\"\n};\nconst _hoisted_7 = [\"onClick\"];\nconst _hoisted_8 = {\n  class: \"action-bar\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", null, [_cache[3] || (_cache[3] = _createElementVNode(\"h2\", null, \"管理投票\", -1 /* HOISTED */)), $data.loading ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, _cache[1] || (_cache[1] = [_createElementVNode(\"span\", null, \"加载中...\", -1 /* HOISTED */)]))) : (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [_createElementVNode(\"div\", _hoisted_3, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.votes, vote => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: vote.id,\n      class: \"vote-item\"\n    }, [_createElementVNode(\"div\", _hoisted_4, [_createElementVNode(\"h3\", null, _toDisplayString(vote.title), 1 /* TEXT */), _createElementVNode(\"p\", null, _toDisplayString(vote.description), 1 /* TEXT */), _createElementVNode(\"div\", _hoisted_5, [_cache[2] || (_cache[2] = _createElementVNode(\"span\", null, \"选项：\", -1 /* HOISTED */)), _createElementVNode(\"ul\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(vote.options, (option, index) => {\n      return _openBlock(), _createElementBlock(\"li\", {\n        key: index\n      }, _toDisplayString(option), 1 /* TEXT */);\n    }), 128 /* KEYED_FRAGMENT */))])])]), _createElementVNode(\"div\", _hoisted_6, [_createElementVNode(\"button\", {\n      class: \"delete-btn\",\n      onClick: $event => $options.deleteVote(vote.id)\n    }, \"删除投票\", 8 /* PROPS */, _hoisted_7)])]);\n  }), 128 /* KEYED_FRAGMENT */))]), _createElementVNode(\"div\", _hoisted_8, [_createElementVNode(\"button\", {\n    class: \"create-btn\",\n    onClick: _cache[0] || (_cache[0] = (...args) => $options.createNewVote && $options.createNewVote(...args))\n  }, \"创建新投票\")])]))]);\n}","map":{"version":3,"names":["key","class","_createElementBlock","_createElementVNode","$data","loading","_hoisted_1","_cache","_hoisted_2","_hoisted_3","_Fragment","_renderList","votes","vote","id","_hoisted_4","_toDisplayString","title","description","_hoisted_5","options","option","index","_hoisted_6","onClick","$event","$options","deleteVote","_hoisted_7","_hoisted_8","args","createNewVote"],"sources":["C:\\Users\\拯救者\\Desktop\\text\\community-service\\src\\components\\AdminManageVotes.vue"],"sourcesContent":["<template>\n  <div>\n    <h2>管理投票</h2>\n    <div v-if=\"loading\" class=\"loading\">\n      <span>加载中...</span>\n    </div>\n    <div v-else>\n      <div class=\"vote-list\">\n        <div v-for=\"vote in votes\" :key=\"vote.id\" class=\"vote-item\">\n          <div class=\"vote-info\">\n            <h3>{{ vote.title }}</h3>\n            <p>{{ vote.description }}</p>\n            <div class=\"vote-options\">\n              <span>选项：</span>\n              <ul>\n                <li v-for=\"(option, index) in vote.options\" :key=\"index\">\n                  {{ option }}\n                </li>\n              </ul>\n            </div>\n          </div>\n          <div class=\"vote-actions\">\n            <button class=\"delete-btn\" @click=\"deleteVote(vote.id)\">删除投票</button>\n          </div>\n        </div>\n      </div>\n      <div class=\"action-bar\">\n        <button class=\"create-btn\" @click=\"createNewVote\">创建新投票</button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport axios from 'axios';\nimport { ElMessage } from 'element-plus';\nimport { adminAuth } from '@/mixins/adminAuth';\nimport 'element-plus/dist/index.css';\nconst API = process.env.VUE_APP_BASE_URL;\n\nexport default {\n  name: 'AdminManageVotes',\n  mixins: [adminAuth],\n  data() {\n    return {\n      votes: [],\n      loading: false,\n    };\n  },\n  mounted() {\n    if (this.checkAdminAuth()) {\n      this.fetchVotes();\n    }\n  },\n  methods: {\n    async fetchVotes() {\n      this.loading = true;\n      try {\n        const response = await axios.get(`${API}/api/canteen/votes`, {\n          headers: {\n            'Authorization': `Bearer ${localStorage.getItem('authToken')}`\n          }\n        });\n        this.votes = response.data;\n      } catch (error) {\n        console.error('获取投票失败:', error);\n        ElMessage.error('获取投票列表失败');\n      } finally {\n        this.loading = false;\n      }\n    },\n\n    async deleteVote(voteId) {\n      if (confirm('确定要删除这个投票吗？')) {\n        try {\n          await axios.delete(`${API}/api/canteen/votes/${voteId}`, {\n            headers: {\n              'Authorization': `Bearer ${localStorage.getItem('authToken')}`\n            }\n          });\n          ElMessage.success('投票删除成功');\n          this.fetchVotes();\n        } catch (error) {\n          console.error('删除投票失败:', error);\n          ElMessage.error('删除投票失败');\n        }\n      }\n    },\n\n    createNewVote() {\n      this.$router.push('/create-vote');\n    },\n  },\n};\n</script>\n\n<style scoped>\n.vote-list {\n  margin: 20px 0;\n}\n\n.vote-item {\n  background: #fff;\n  border-radius: 8px;\n  padding: 20px;\n  margin-bottom: 15px;\n  box-shadow: 0 2px 8px rgba(0,0,0,0.1);\n  display: flex;\n  justify-content: space-between;\n  align-items: flex-start;\n}\n\n.vote-info {\n  flex: 1;\n}\n\n.vote-info h3 {\n  margin: 0 0 10px 0;\n  color: #333;\n}\n\n.vote-info p {\n  color: #666;\n  margin: 0 0 10px 0;\n}\n\n.vote-options {\n  margin-top: 10px;\n}\n\n.vote-options ul {\n  list-style: none;\n  padding-left: 20px;\n  margin: 5px 0;\n}\n\n.vote-options li {\n  color: #666;\n  margin: 3px 0;\n}\n\n.vote-actions {\n  margin-left: 20px;\n}\n\n.delete-btn {\n  padding: 8px 16px;\n  background-color: #f56c6c;\n  color: white;\n  border: none;\n  border-radius: 4px;\n  cursor: pointer;\n  transition: all 0.3s;\n}\n\n.delete-btn:hover {\n  background-color: #ff7875;\n}\n\n.action-bar {\n  margin-top: 20px;\n  text-align: right;\n}\n\n.create-btn {\n  padding: 10px 20px;\n  background-color: #409eff;\n  color: white;\n  border: none;\n  border-radius: 4px;\n  cursor: pointer;\n  transition: all 0.3s;\n}\n\n.create-btn:hover {\n  background-color: #66b1ff;\n}\n\n.loading {\n  text-align: center;\n  padding: 20px;\n  color: #666;\n}\n</style>"],"mappings":";;EAAAA,GAAA;EAGwBC,KAAK,EAAC;;;EAH9BD,GAAA;AAAA;;EAOWC,KAAK,EAAC;AAAW;;EAEbA,KAAK,EAAC;AAAW;;EAGfA,KAAK,EAAC;AAAc;;EAStBA,KAAK,EAAC;AAAc;mBArBnC;;EA0BWA,KAAK,EAAC;AAAY;;uBAzB3BC,mBAAA,CA6BM,c,0BA5BJC,mBAAA,CAAa,YAAT,MAAI,sBACGC,KAAA,CAAAC,OAAO,I,cAAlBH,mBAAA,CAEM,OAFNI,UAEM,EAAAC,MAAA,QAAAA,MAAA,OADJJ,mBAAA,CAAmB,cAAb,QAAM,oB,qBAEdD,mBAAA,CAuBM,OA7BVM,UAAA,GAOML,mBAAA,CAkBM,OAlBNM,UAkBM,I,kBAjBJP,mBAAA,CAgBMQ,SAAA,QAxBdC,WAAA,CAQ4BP,KAAA,CAAAQ,KAAK,EAAbC,IAAI;yBAAhBX,mBAAA,CAgBM;MAhBsBF,GAAG,EAAEa,IAAI,CAACC,EAAE;MAAEb,KAAK,EAAC;QAC9CE,mBAAA,CAWM,OAXNY,UAWM,GAVJZ,mBAAA,CAAyB,YAAAa,gBAAA,CAAlBH,IAAI,CAACI,KAAK,kBACjBd,mBAAA,CAA6B,WAAAa,gBAAA,CAAvBH,IAAI,CAACK,WAAW,kBACtBf,mBAAA,CAOM,OAPNgB,UAOM,G,0BANJhB,mBAAA,CAAgB,cAAV,KAAG,sBACTA,mBAAA,CAIK,c,kBAHHD,mBAAA,CAEKQ,SAAA,QAjBrBC,WAAA,CAe8CE,IAAI,CAACO,OAAO,EAf1D,CAe4BC,MAAM,EAAEC,KAAK;2BAAzBpB,mBAAA,CAEK;QAFwCF,GAAG,EAAEsB;MAAK,GAAAN,gBAAA,CAClDK,MAAM;0CAKjBlB,mBAAA,CAEM,OAFNoB,UAEM,GADJpB,mBAAA,CAAqE;MAA7DF,KAAK,EAAC,YAAY;MAAEuB,OAAK,EAAAC,MAAA,IAAEC,QAAA,CAAAC,UAAU,CAACd,IAAI,CAACC,EAAE;OAAG,MAAI,iBAtBxEc,UAAA,E;oCA0BMzB,mBAAA,CAEM,OAFN0B,UAEM,GADJ1B,mBAAA,CAAgE;IAAxDF,KAAK,EAAC,YAAY;IAAEuB,OAAK,EAAAjB,MAAA,QAAAA,MAAA,UAAAuB,IAAA,KAAEJ,QAAA,CAAAK,aAAA,IAAAL,QAAA,CAAAK,aAAA,IAAAD,IAAA,CAAa;KAAE,OAAK,E","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}