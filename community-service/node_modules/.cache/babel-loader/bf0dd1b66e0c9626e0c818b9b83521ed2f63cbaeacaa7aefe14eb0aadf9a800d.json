{"ast":null,"code":"import \"core-js/modules/web.url-search-params.delete.js\";\nimport \"core-js/modules/web.url-search-params.has.js\";\nimport \"core-js/modules/web.url-search-params.size.js\";\nimport axios from 'axios';\nimport { handleApiError } from '../utils/errorHandler';\nconst API = process.env.VUE_APP_API_URL;\nexport default {\n  data() {\n    return {\n      menuItems: [],\n      newItem: {\n        name: '',\n        price: '',\n        image_url: '',\n        description: ''\n      },\n      imageFile: null,\n      isEditing: false,\n      imageCache: new Map() // 添加图片缓存\n    };\n  },\n  mounted() {\n    this.fetchMenuItems(); // 加载菜品数据\n  },\n  methods: {\n    async compressImage(file) {\n      return new Promise(resolve => {\n        const reader = new FileReader();\n        reader.onload = e => {\n          const img = new Image();\n          img.onload = () => {\n            const canvas = document.createElement('canvas');\n            let width = img.width;\n            let height = img.height;\n\n            // 如果图片大于 1000px，按比例缩小\n            const maxSize = 1000;\n            if (width > maxSize || height > maxSize) {\n              if (width > height) {\n                height = Math.round(height * maxSize / width);\n                width = maxSize;\n              } else {\n                width = Math.round(width * maxSize / height);\n                height = maxSize;\n              }\n            }\n            canvas.width = width;\n            canvas.height = height;\n            const ctx = canvas.getContext('2d');\n            ctx.drawImage(img, 0, 0, width, height);\n\n            // 压缩图片质量\n            canvas.toBlob(blob => {\n              resolve(new File([blob], file.name, {\n                type: 'image/jpeg',\n                lastModified: Date.now()\n              }));\n            }, 'image/jpeg', 0.7); // 0.7 是压缩质量\n          };\n          img.src = e.target.result;\n        };\n        reader.readAsDataURL(file);\n      });\n    },\n    async handleFileUpload(event) {\n      const file = event.target.files[0];\n      if (!file) return;\n\n      // 检查文件类型\n      if (!file.type.startsWith('image/')) {\n        alert('请上传图片文件');\n        this.$refs.fileInput.value = '';\n        return;\n      }\n\n      // 检查文件大小（限制为 5MB）\n      const maxSize = 5 * 1024 * 1024; // 5MB\n      if (file.size > maxSize) {\n        alert('图片大小不能超过 5MB，系统将自动压缩');\n      }\n      try {\n        // 压缩图片\n        const compressedFile = await this.compressImage(file);\n        this.imageFile = compressedFile;\n      } catch (error) {\n        console.error('图片压缩失败:', error);\n        alert('图片处理失败，请重试');\n        this.$refs.fileInput.value = '';\n      }\n    },\n    async fetchMenuItems() {\n      try {\n        const response = await axios.get(`${API}/canteen/menu`, {\n          headers: {\n            'Authorization': `Bearer ${localStorage.getItem('authToken')}`\n          }\n        });\n        this.menuItems = response.data; // 获取菜品数据\n        // 预加载所有图片\n        for (const item of this.menuItems) {\n          await this.loadImage(item);\n        }\n      } catch (error) {\n        handleApiError(error);\n      }\n    },\n    async addMenuItem() {\n      const formData = new FormData();\n      formData.append('name', this.newItem.name);\n      formData.append('price', this.newItem.price);\n      formData.append('image_url', this.newItem.image_url);\n      formData.append('description', this.newItem.description);\n      if (this.imageFile) {\n        formData.append('image', this.imageFile); // 添加文件到formData\n      }\n      try {\n        await axios.post(`${API}/canteen/menu`, formData, {\n          headers: {\n            'Authorization': `Bearer ${localStorage.getItem('authToken')}`,\n            'Content-Type': 'multipart/form-data'\n          }\n        });\n        this.fetchMenuItems(); // 刷新菜单列表\n        this.resetForm();\n      } catch (error) {\n        handleApiError(error, {\n          suppressAuthError: true,\n          customErrorHandler: () => {\n            alert('添加菜品失败，请重试');\n          }\n        });\n      }\n    },\n    async deleteMenuItem(itemId) {\n      try {\n        await axios.delete(`${API}/canteen/menu/${itemId}`, {\n          headers: {\n            'Authorization': `Bearer ${localStorage.getItem('authToken')}`\n          }\n        });\n        this.fetchMenuItems(); // 刷新菜单列表\n      } catch (error) {\n        handleApiError(error, {\n          suppressAuthError: true,\n          customErrorHandler: () => {\n            alert('删除菜品失败，请重试');\n          }\n        });\n      }\n    },\n    editMenuItem(item) {\n      this.newItem = {\n        ...item\n      };\n      this.isEditing = true; // 设置为编辑状态\n    },\n    async updateMenuItem() {\n      const formData = new FormData();\n      formData.append('name', this.newItem.name);\n      formData.append('price', this.newItem.price);\n      formData.append('image_url', this.newItem.image_url);\n      formData.append('description', this.newItem.description);\n      if (this.imageFile) {\n        formData.append('image', this.imageFile); // 添加文件到formData\n      }\n      try {\n        await axios.put(`${API}/canteen/menu/${this.newItem.id}`, formData, {\n          headers: {\n            'Authorization': `Bearer ${localStorage.getItem('authToken')}`,\n            'Content-Type': 'multipart/form-data'\n          }\n        });\n        this.fetchMenuItems(); // 刷新菜单列表\n        this.resetForm();\n      } catch (error) {\n        handleApiError(error, {\n          suppressAuthError: true,\n          customErrorHandler: () => {\n            alert('更新菜品失败，请重试');\n          }\n        });\n      }\n    },\n    cancelEdit() {\n      this.resetForm(); // 清空表单\n    },\n    resetForm() {\n      this.isEditing = false;\n      this.newItem = {\n        name: '',\n        price: '',\n        image_url: '',\n        description: ''\n      };\n      this.imageFile = null; // 重置文件字段\n      this.$refs.fileInput.value = ''; // 清空文件输入\n    },\n    async loadImage(item) {\n      if (!item.image_url) return;\n      item.blobUrl = await this.getImageUrl(item.image_url);\n    },\n    async getImageUrl(path) {\n      if (!path) return '';\n      if (path.startsWith('http')) {\n        return path;\n      }\n\n      // 检查缓存\n      if (this.imageCache.has(path)) {\n        return this.imageCache.get(path);\n      }\n      try {\n        const token = localStorage.getItem('authToken');\n        const headers = {\n          'Authorization': `Bearer ${token}`\n        };\n        const uploadPath = path.startsWith('/uploads/') ? path : `/uploads/${path}`;\n        const baseUrl = process.env.VUE_APP_BASE_URL || 'http://localhost:3000';\n        const response = await fetch(`${baseUrl}${uploadPath}`, {\n          headers\n        });\n        const blob = await response.blob();\n        const blobUrl = URL.createObjectURL(blob);\n\n        // 存入缓存\n        this.imageCache.set(path, blobUrl);\n        return blobUrl;\n      } catch (error) {\n        console.error('加载图片失败:', error);\n        return '';\n      }\n    }\n  }\n};","map":{"version":3,"names":["axios","handleApiError","API","process","env","VUE_APP_API_URL","data","menuItems","newItem","name","price","image_url","description","imageFile","isEditing","imageCache","Map","mounted","fetchMenuItems","methods","compressImage","file","Promise","resolve","reader","FileReader","onload","e","img","Image","canvas","document","createElement","width","height","maxSize","Math","round","ctx","getContext","drawImage","toBlob","blob","File","type","lastModified","Date","now","src","target","result","readAsDataURL","handleFileUpload","event","files","startsWith","alert","$refs","fileInput","value","size","compressedFile","error","console","response","get","headers","localStorage","getItem","item","loadImage","addMenuItem","formData","FormData","append","post","resetForm","suppressAuthError","customErrorHandler","deleteMenuItem","itemId","delete","editMenuItem","updateMenuItem","put","id","cancelEdit","blobUrl","getImageUrl","path","has","token","uploadPath","baseUrl","VUE_APP_BASE_URL","fetch","URL","createObjectURL","set"],"sources":["C:\\Users\\拯救者\\Desktop\\text\\community-service\\src\\components\\CanteenAdmin.vue"],"sourcesContent":["<template>\n  <div class=\"canteen-admin\">\n    <h2>食堂管理</h2>\n\n    <!-- 添加/编辑菜品的表单 -->\n    <div class=\"form-container\">\n      <h3>{{ isEditing ? '编辑菜品' : '添加新菜品' }}</h3>\n      <form @submit.prevent=\"isEditing ? updateMenuItem() : addMenuItem()\" class=\"form\">\n        <div class=\"form-group\">\n          <label for=\"name\">菜品名称</label>\n          <input id=\"name\" type=\"text\" v-model=\"newItem.name\" required placeholder=\"输入菜品名称\" />\n        </div>\n        <div class=\"form-group\">\n          <label for=\"price\">价格</label>\n          <input id=\"price\" type=\"number\" v-model=\"newItem.price\" required placeholder=\"输入菜品价格\" />\n        </div>\n        <div class=\"form-group\">\n          <label for=\"image-url\">图片链接</label>\n          <input id=\"image-url\" type=\"text\" v-model=\"newItem.image_url\" placeholder=\"输入图片URL\" />\n        </div>\n        <div class=\"form-group\">\n          <label>或上传图片</label>\n          <input type=\"file\" @change=\"handleFileUpload\" ref=\"fileInput\" />\n        </div>\n        <div class=\"form-group\">\n          <label for=\"description\">描述</label>\n          <textarea id=\"description\" v-model=\"newItem.description\" placeholder=\"输入菜品描述\"></textarea>\n        </div>\n        <div class=\"form-actions\">\n          <button type=\"submit\" class=\"submit-btn\">{{ isEditing ? '更新菜品' : '添加菜品' }}</button>\n          <button type=\"button\" @click=\"cancelEdit\" v-if=\"isEditing\" class=\"cancel-btn\">取消</button>\n        </div>\n      </form>\n    </div>\n\n    <!-- 菜品列表 -->\n    <h3>菜品列表</h3>\n    <div v-if=\"menuItems.length > 0\" class=\"menu-list\">\n      <div v-for=\"item in menuItems\" :key=\"item.id\" class=\"menu-item\">\n        <img v-if=\"item.image_url\" :src=\"item.blobUrl || ''\" @error=\"loadImage(item)\" alt=\"菜品图片\" />\n        <div class=\"menu-item-info\">\n          <h4>{{ item.name }}</h4>\n          <p class=\"price\">价格: {{ item.price }} 元</p>\n          <p class=\"description\">{{ item.description }}</p>\n        </div>\n        <div class=\"menu-item-actions\">\n          <button @click=\"deleteMenuItem(item.id)\" class=\"delete-btn\">删除</button>\n          <button @click=\"editMenuItem(item)\" class=\"edit-btn\">编辑</button>\n        </div>\n      </div>\n    </div>\n    <div v-else>\n      <p>目前没有可用的菜品。</p>\n    </div>\n  </div>\n</template>\n\n<script>\nimport axios from 'axios';\nimport { handleApiError } from '../utils/errorHandler';\nconst API = process.env.VUE_APP_API_URL;\n\nexport default {\n  data() {\n    return {\n      menuItems: [],\n      newItem: { name: '', price: '', image_url: '', description: '' },\n      imageFile: null,\n      isEditing: false,\n      imageCache: new Map(), // 添加图片缓存\n    };\n  },\n  mounted() {\n    this.fetchMenuItems(); // 加载菜品数据\n  },\n  methods: {\n    async compressImage(file) {\n      return new Promise((resolve) => {\n        const reader = new FileReader();\n        reader.onload = (e) => {\n          const img = new Image();\n          img.onload = () => {\n            const canvas = document.createElement('canvas');\n            let width = img.width;\n            let height = img.height;\n            \n            // 如果图片大于 1000px，按比例缩小\n            const maxSize = 1000;\n            if (width > maxSize || height > maxSize) {\n              if (width > height) {\n                height = Math.round((height * maxSize) / width);\n                width = maxSize;\n              } else {\n                width = Math.round((width * maxSize) / height);\n                height = maxSize;\n              }\n            }\n\n            canvas.width = width;\n            canvas.height = height;\n            const ctx = canvas.getContext('2d');\n            ctx.drawImage(img, 0, 0, width, height);\n            \n            // 压缩图片质量\n            canvas.toBlob((blob) => {\n              resolve(new File([blob], file.name, {\n                type: 'image/jpeg',\n                lastModified: Date.now()\n              }));\n            }, 'image/jpeg', 0.7); // 0.7 是压缩质量\n          };\n          img.src = e.target.result;\n        };\n        reader.readAsDataURL(file);\n      });\n    },\n    async handleFileUpload(event) {\n      const file = event.target.files[0];\n      if (!file) return;\n\n      // 检查文件类型\n      if (!file.type.startsWith('image/')) {\n        alert('请上传图片文件');\n        this.$refs.fileInput.value = '';\n        return;\n      }\n\n      // 检查文件大小（限制为 5MB）\n      const maxSize = 5 * 1024 * 1024; // 5MB\n      if (file.size > maxSize) {\n        alert('图片大小不能超过 5MB，系统将自动压缩');\n      }\n\n      try {\n        // 压缩图片\n        const compressedFile = await this.compressImage(file);\n        this.imageFile = compressedFile;\n      } catch (error) {\n        console.error('图片压缩失败:', error);\n        alert('图片处理失败，请重试');\n        this.$refs.fileInput.value = '';\n      }\n    },\n    async fetchMenuItems() {\n      try {\n        const response = await axios.get(`${API}/canteen/menu`, {\n          headers: {\n            'Authorization': `Bearer ${localStorage.getItem('authToken')}`\n          }\n        });\n        this.menuItems = response.data; // 获取菜品数据\n        // 预加载所有图片\n        for (const item of this.menuItems) {\n          await this.loadImage(item);\n        }\n      } catch (error) {\n        handleApiError(error);\n      }\n    },\n    async addMenuItem() {\n      const formData = new FormData();\n      formData.append('name', this.newItem.name);\n      formData.append('price', this.newItem.price);\n      formData.append('image_url', this.newItem.image_url);\n      formData.append('description', this.newItem.description);\n      if (this.imageFile) {\n        formData.append('image', this.imageFile); // 添加文件到formData\n      }\n\n      try {\n        await axios.post(`${API}/canteen/menu`, formData, {\n          headers: {\n            'Authorization': `Bearer ${localStorage.getItem('authToken')}`,\n            'Content-Type': 'multipart/form-data'\n          }\n        });\n        this.fetchMenuItems(); // 刷新菜单列表\n        this.resetForm();\n      } catch (error) {\n        handleApiError(error, {\n          suppressAuthError: true,\n          customErrorHandler: () => {\n            alert('添加菜品失败，请重试');\n          }\n        });\n      }\n    },\n    async deleteMenuItem(itemId) {\n      try {\n        await axios.delete(`${API}/canteen/menu/${itemId}`, {\n          headers: {\n            'Authorization': `Bearer ${localStorage.getItem('authToken')}`\n          }\n        });\n        this.fetchMenuItems(); // 刷新菜单列表\n      } catch (error) {\n        handleApiError(error, {\n          suppressAuthError: true,\n          customErrorHandler: () => {\n            alert('删除菜品失败，请重试');\n          }\n        });\n      }\n    },\n    editMenuItem(item) {\n      this.newItem = { ...item };\n      this.isEditing = true; // 设置为编辑状态\n    },\n    async updateMenuItem() {\n      const formData = new FormData();\n      formData.append('name', this.newItem.name);\n      formData.append('price', this.newItem.price);\n      formData.append('image_url', this.newItem.image_url);\n      formData.append('description', this.newItem.description);\n      if (this.imageFile) {\n        formData.append('image', this.imageFile); // 添加文件到formData\n      }\n\n      try {\n        await axios.put(\n          `${API}/canteen/menu/${this.newItem.id}`, \n          formData,\n          {\n            headers: {\n              'Authorization': `Bearer ${localStorage.getItem('authToken')}`,\n              'Content-Type': 'multipart/form-data'\n            }\n          }\n        );\n        this.fetchMenuItems(); // 刷新菜单列表\n        this.resetForm();\n      } catch (error) {\n        handleApiError(error, {\n          suppressAuthError: true,\n          customErrorHandler: () => {\n            alert('更新菜品失败，请重试');\n          }\n        });\n      }\n    },\n    cancelEdit() {\n      this.resetForm(); // 清空表单\n    },\n    resetForm() {\n      this.isEditing = false;\n      this.newItem = { name: '', price: '', image_url: '', description: '' };\n      this.imageFile = null; // 重置文件字段\n      this.$refs.fileInput.value = ''; // 清空文件输入\n    },\n    async loadImage(item) {\n      if (!item.image_url) return;\n      item.blobUrl = await this.getImageUrl(item.image_url);\n    },\n    async getImageUrl(path) {\n      if (!path) return ''; \n      if (path.startsWith('http')) {\n        return path;\n      }\n      \n      // 检查缓存\n      if (this.imageCache.has(path)) {\n        return this.imageCache.get(path);\n      }\n\n      try {\n        const token = localStorage.getItem('authToken');\n        const headers = { 'Authorization': `Bearer ${token}` };\n        const uploadPath = path.startsWith('/uploads/') ? path : `/uploads/${path}`;\n        const baseUrl = process.env.VUE_APP_BASE_URL || 'http://localhost:3000';\n        const response = await fetch(`${baseUrl}${uploadPath}`, { headers });\n        const blob = await response.blob();\n        const blobUrl = URL.createObjectURL(blob);\n        \n        // 存入缓存\n        this.imageCache.set(path, blobUrl);\n        \n        return blobUrl;\n      } catch (error) {\n        console.error('加载图片失败:', error);\n        return '';\n      }\n    }\n  }\n};\n</script>\n\n<style scoped>\n.canteen-admin {\n  padding: 30px;\n  font-family: Arial, sans-serif;\n}\n\n.form-container {\n  background-color: #f9f9f9;\n  padding: 20px;\n  border-radius: 8px;\n  box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\n  margin-bottom: 20px;\n}\n\n.form h3 {\n  font-size: 1.5em;\n  margin-bottom: 20px;\n}\n\n.form-group {\n  margin-bottom: 15px;\n}\n\nlabel {\n  display: block;\n  font-weight: bold;\n  margin-bottom: 5px;\n}\n\ninput, textarea {\n  width: 100%;\n  padding: 10px;\n  border-radius: 5px;\n  border: 1px solid #ccc;\n  font-size: 1em;\n}\n\ntextarea {\n  min-height: 100px;\n  resize: vertical;\n}\n\nbutton {\n  padding: 10px 20px;\n  border-radius: 5px;\n  border: none;\n  cursor: pointer;\n  font-size: 1em;\n}\n\n.submit-btn {\n  background-color: #4CAF50;\n  color: white;\n}\n\n.submit-btn:hover {\n  background-color: #45a049;\n}\n\n.cancel-btn {\n  background-color: #f44336;\n  color: white;\n  margin-left: 10px;\n}\n\n.cancel-btn:hover {\n  background-color: #e53935;\n}\n\n.menu-list {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));\n  gap: 20px;\n}\n\n.menu-item {\n  background-color: #fff;\n  border-radius: 8px;\n  box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\n  overflow: hidden;\n  padding: 15px;\n  transition: transform 0.3s ease;\n}\n\n.menu-item:hover {\n  transform: translateY(-5px);\n}\n\n.menu-item img {\n  width: 100%;\n  height: auto;\n  border-radius: 5px;\n}\n\n.menu-item-info {\n  padding: 10px 0;\n}\n\n.menu-item-info h4 {\n  font-size: 1.2em;\n  margin: 0;\n}\n\n.menu-item-info .price {\n  color: #4CAF50;\n}\n\n.menu-item-actions {\n  margin-top: 10px;\n}\n\n.menu-item-actions button {\n  margin-right: 10px;\n  padding: 8px 15px;\n  border-radius: 5px;\n  font-size: 0.9em;\n}\n\n.edit-btn {\n  background-color: #2196F3;\n  color: white;\n}\n\n.edit-btn:hover {\n  background-color: #1976D2;\n}\n\n.delete-btn {\n  background-color: #f44336;\n  color: white;\n}\n\n.delete-btn:hover {\n  background-color: #e53935;\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}