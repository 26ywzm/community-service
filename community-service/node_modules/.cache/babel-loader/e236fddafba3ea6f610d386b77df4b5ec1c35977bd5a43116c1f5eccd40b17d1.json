{"ast":null,"code":"import { resolveComponent as _resolveComponent, createVNode as _createVNode, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, withCtx as _withCtx, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"order-detail\"\n};\nconst _hoisted_2 = {\n  class: \"card-header\"\n};\nconst _hoisted_3 = {\n  class: \"price\"\n};\nconst _hoisted_4 = {\n  key: 1,\n  class: \"order-items\"\n};\nconst _hoisted_5 = {\n  class: \"items-list\"\n};\nconst _hoisted_6 = {\n  class: \"item-content\"\n};\nconst _hoisted_7 = {\n  class: \"item-info\"\n};\nconst _hoisted_8 = {\n  class: \"item-name\"\n};\nconst _hoisted_9 = {\n  class: \"item-price\"\n};\nconst _hoisted_10 = {\n  class: \"item-details\"\n};\nconst _hoisted_11 = {\n  class: \"quantity\"\n};\nconst _hoisted_12 = {\n  class: \"subtotal\"\n};\nconst _hoisted_13 = {\n  class: \"total-section\"\n};\nconst _hoisted_14 = {\n  key: 2,\n  class: \"loading-state\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_el_page_header = _resolveComponent(\"el-page-header\");\n  const _component_el_tag = _resolveComponent(\"el-tag\");\n  const _component_el_descriptions_item = _resolveComponent(\"el-descriptions-item\");\n  const _component_el_descriptions = _resolveComponent(\"el-descriptions\");\n  const _component_el_card = _resolveComponent(\"el-card\");\n  const _component_el_statistic = _resolveComponent(\"el-statistic\");\n  const _component_el_empty = _resolveComponent(\"el-empty\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createVNode(_component_el_card, {\n    class: \"detail-card\"\n  }, {\n    header: _withCtx(() => [_createElementVNode(\"div\", _hoisted_2, [_createVNode(_component_el_page_header, {\n      onBack: $setup.goBack,\n      title: '返回',\n      content: '订单详情 #' + $setup.orderId\n    }, null, 8 /* PROPS */, [\"onBack\", \"content\"])])]),\n    default: _withCtx(() => [$setup.order ? (_openBlock(), _createBlock(_component_el_descriptions, {\n      key: 0,\n      class: \"margin-bottom\",\n      title: \"订单信息\",\n      column: 1,\n      border: \"\"\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_descriptions_item, {\n        label: \"订单状态\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_tag, {\n          type: $setup.getStatusType($setup.order.status)\n        }, {\n          default: _withCtx(() => [_createTextVNode(_toDisplayString($setup.getOrderStatusText($setup.order.status)), 1 /* TEXT */)]),\n          _: 1 /* STABLE */\n        }, 8 /* PROPS */, [\"type\"])]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_descriptions_item, {\n        label: \"用户信息\"\n      }, {\n        default: _withCtx(() => [_createTextVNode(_toDisplayString($setup.order.user.username) + \" (\" + _toDisplayString($setup.order.user.email) + \") \", 1 /* TEXT */)]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_descriptions_item, {\n        label: \"订单创建时间\"\n      }, {\n        default: _withCtx(() => [_createTextVNode(_toDisplayString($setup.formatDate($setup.order.created_at)), 1 /* TEXT */)]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_descriptions_item, {\n        label: \"总价\"\n      }, {\n        default: _withCtx(() => [_createElementVNode(\"span\", _hoisted_3, \"¥\" + _toDisplayString($setup.order.total_price), 1 /* TEXT */)]),\n        _: 1 /* STABLE */\n      })]),\n      _: 1 /* STABLE */\n    })) : _createCommentVNode(\"v-if\", true), $setup.order && $setup.order.items && $setup.order.items.length > 0 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [_cache[1] || (_cache[1] = _createElementVNode(\"h3\", null, \"订单商品\", -1 /* HOISTED */)), _createElementVNode(\"div\", _hoisted_5, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.order.items, item => {\n      return _openBlock(), _createBlock(_component_el_card, {\n        key: item.menu_item_id,\n        class: \"item-card\"\n      }, {\n        default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_6, [_createElementVNode(\"div\", _hoisted_7, [_createElementVNode(\"span\", _hoisted_8, _toDisplayString(item.menu_item_name), 1 /* TEXT */), _createElementVNode(\"span\", _hoisted_9, \"¥\" + _toDisplayString(item.price), 1 /* TEXT */)]), _createElementVNode(\"div\", _hoisted_10, [_createElementVNode(\"span\", _hoisted_11, \"数量：\" + _toDisplayString(item.quantity), 1 /* TEXT */), _createElementVNode(\"span\", _hoisted_12, \"小计：¥\" + _toDisplayString(Number(item.price * item.quantity).toFixed(2)), 1 /* TEXT */)])])]),\n        _: 2 /* DYNAMIC */\n      }, 1024 /* DYNAMIC_SLOTS */);\n    }), 128 /* KEYED_FRAGMENT */))]), _createElementVNode(\"div\", _hoisted_13, [_createVNode(_component_el_statistic, {\n      title: \"订单总价\",\n      value: $setup.order.total_price,\n      prefix: \"¥\"\n    }, {\n      suffix: _withCtx(() => _cache[0] || (_cache[0] = [_createElementVNode(\"span\", {\n        class: \"small-text\"\n      }, \"元\", -1 /* HOISTED */)])),\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"value\"])])])) : _createCommentVNode(\"v-if\", true), !$setup.order ? (_openBlock(), _createElementBlock(\"div\", _hoisted_14, [_createVNode(_component_el_empty, {\n      description: \"订单信息加载中...\"\n    })])) : _createCommentVNode(\"v-if\", true)]),\n    _: 1 /* STABLE */\n  })]);\n}","map":{"version":3,"names":["class","key","_createElementBlock","_hoisted_1","_createVNode","_component_el_card","header","_withCtx","_createElementVNode","_hoisted_2","_component_el_page_header","onBack","$setup","goBack","title","content","orderId","default","order","_createBlock","_component_el_descriptions","column","border","_component_el_descriptions_item","label","_component_el_tag","type","getStatusType","status","_createTextVNode","_toDisplayString","getOrderStatusText","_","user","username","email","formatDate","created_at","_hoisted_3","total_price","_createCommentVNode","items","length","_hoisted_4","_hoisted_5","_Fragment","_renderList","item","menu_item_id","_hoisted_6","_hoisted_7","_hoisted_8","menu_item_name","_hoisted_9","price","_hoisted_10","_hoisted_11","quantity","_hoisted_12","Number","toFixed","_hoisted_13","_component_el_statistic","value","prefix","suffix","_cache","_hoisted_14","_component_el_empty","description"],"sources":["C:\\Users\\拯救者\\Desktop\\text\\community-service\\src\\components\\OrderDetail.vue"],"sourcesContent":["<template>\n  <div class=\"order-detail\">\n    <el-card class=\"detail-card\">\n      <template #header>\n        <div class=\"card-header\">\n          <el-page-header @back=\"goBack\" :title=\"'返回'\" :content=\"'订单详情 #' + orderId\" />\n        </div>\n      </template>\n\n      <el-descriptions v-if=\"order\" class=\"margin-bottom\" title=\"订单信息\" :column=\"1\" border>\n        <el-descriptions-item label=\"订单状态\">\n          <el-tag :type=\"getStatusType(order.status)\">\n            {{ getOrderStatusText(order.status) }}\n          </el-tag>\n        </el-descriptions-item>\n        <el-descriptions-item label=\"用户信息\">\n          {{ order.user.username }} ({{ order.user.email }})\n        </el-descriptions-item>\n        <el-descriptions-item label=\"订单创建时间\">\n          {{ formatDate(order.created_at) }}\n        </el-descriptions-item>\n        <el-descriptions-item label=\"总价\">\n          <span class=\"price\">¥{{ order.total_price }}</span>\n        </el-descriptions-item>\n      </el-descriptions>\n\n      <div v-if=\"order && order.items && order.items.length > 0\" class=\"order-items\">\n        <h3>订单商品</h3>\n        <div class=\"items-list\">\n          <el-card v-for=\"item in order.items\" \n                  :key=\"item.menu_item_id\" \n                  class=\"item-card\">\n            <div class=\"item-content\">\n              <div class=\"item-info\">\n                <span class=\"item-name\">{{ item.menu_item_name }}</span>\n                <span class=\"item-price\">¥{{ item.price }}</span>\n              </div>\n              <div class=\"item-details\">\n                <span class=\"quantity\">数量：{{ item.quantity }}</span>\n                <span class=\"subtotal\">小计：¥{{ Number(item.price * item.quantity).toFixed(2) }}</span>\n              </div>\n            </div>\n          </el-card>\n        </div>\n\n        <div class=\"total-section\">\n          <el-statistic title=\"订单总价\" :value=\"order.total_price\" prefix=\"¥\">\n            <template #suffix>\n              <span class=\"small-text\">元</span>\n            </template>\n          </el-statistic>\n        </div>\n      </div>\n\n      <div v-if=\"!order\" class=\"loading-state\">\n        <el-empty description=\"订单信息加载中...\" />\n      </div>\n    </el-card>\n  </div>\n</template>\n\n<script>\nimport { ref, onMounted } from 'vue'\nimport axios from 'axios'\nimport { useRoute, useRouter } from 'vue-router'\nimport { ElMessage } from 'element-plus'\n\nexport default {\n  name: 'OrderDetail',\n  setup() {\n    const route = useRoute()\n    const router = useRouter()\n    const order = ref(null)\n    const orderId = route.params.orderId\n\n    const calculateSubtotal = (row) => {\n      if (!row || typeof row.price !== 'number' || typeof row.quantity !== 'number') {\n        return '0.00'\n      }\n      return (row.price * row.quantity).toFixed(2)\n    }\n\n    const fetchOrderDetails = async () => {\n      try {\n        const response = await axios.get(`${process.env.VUE_APP_API_URL}/canteen/order/${orderId}`, {\n          headers: {\n            Authorization: `Bearer ${localStorage.getItem('authToken')}`\n          }\n        })\n        if (response.data && response.data.user) {\n          order.value = {\n            ...response.data,\n            email: response.data.user.email,\n            username: response.data.user.username\n          }\n        } else {\n          order.value = response.data\n        }\n      } catch (error) {\n        ElMessage.error('获取订单详情失败，请稍后重试')\n        console.error('Error fetching order details:', error)\n      }\n    }\n\n    const goBack = () => {\n      router.back()\n    }\n\n    const getOrderStatusText = (status) => {\n      const statusMap = {\n        0: '待处理',\n        1: '处理中',\n        2: '已完成',\n        3: '已取消'\n      }\n      return statusMap[status] || '未知状态'\n    }\n\n    const getStatusType = (status) => {\n      const typeMap = {\n        0: 'info',    // 待处理\n        1: 'warning', // 处理中\n        2: 'success', // 已完成\n        3: 'danger'   // 已取消\n      }\n      return typeMap[status] || 'info'\n    }\n\n    const formatDate = (dateString) => {\n      if (!dateString) return '感谢使用'\n      try {\n        const date = new Date(dateString)\n        if (isNaN(date.getTime())) return '--'\n        const options = { \n          year: \"numeric\", \n          month: \"2-digit\", \n          day: \"2-digit\", \n          hour: \"2-digit\", \n          minute: \"2-digit\",\n          hour12: false \n        }\n        return date.toLocaleString(\"zh-CN\", options).replace(/\\//g, '-')\n      } catch (error) {\n        console.error('日期格式化错误:', error)\n        return '--'\n      }\n    }\n\n    onMounted(() => {\n      fetchOrderDetails()\n    })\n\n    return {\n      order,\n      orderId,\n      goBack,\n      getOrderStatusText,\n      getStatusType,\n      formatDate,\n      calculateSubtotal\n    }\n  }\n}\n</script>\n\n<style scoped>\n.order-detail {\n  max-width: 1000px;\n  margin: 20px auto;\n  padding: 0 20px;\n}\n\n.detail-card {\n  margin-bottom: 20px;\n}\n\n.card-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.margin-bottom {\n  margin-bottom: 20px;\n}\n\n.order-items {\n  margin-top: 30px;\n}\n\n.order-items h3 {\n  margin-bottom: 20px;\n  color: #303133;\n  font-weight: 500;\n}\n\n.items-list {\n  display: flex;\n  flex-direction: column;\n  gap: 16px;\n}\n\n.item-card {\n  transition: all 0.3s;\n}\n\n.item-card:hover {\n  transform: translateY(-2px);\n  box-shadow: 0 2px 12px 0 rgba(0,0,0,0.1);\n}\n\n.item-content {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n\n.item-info {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.item-name {\n  font-size: 16px;\n  font-weight: 500;\n  color: #303133;\n}\n\n.item-price {\n  color: #f56c6c;\n  font-weight: 500;\n}\n\n.item-details {\n  display: flex;\n  justify-content: space-between;\n  color: #606266;\n  font-size: 14px;\n}\n\n.quantity {\n  color: #909399;\n}\n\n.subtotal {\n  color: #409EFF;\n  font-weight: 500;\n}\n\n.total-section {\n  margin-top: 30px;\n  display: flex;\n  justify-content: flex-end;\n  padding: 20px;\n  background-color: #f8f9fa;\n  border-radius: 8px;\n}\n\n.small-text {\n  font-size: 14px;\n  color: #909399;\n  margin-left: 4px;\n}\n\n:deep(.el-descriptions) {\n  margin-bottom: 20px;\n}\n\n:deep(.el-descriptions__title) {\n  font-size: 18px;\n  font-weight: 500;\n  margin-bottom: 16px;\n}\n\n:deep(.el-descriptions__label) {\n  font-weight: 500;\n}\n\n.loading-state {\n  padding: 40px 0;\n  text-align: center;\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}