{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport router from '../router';\nexport const handleAuthError = (shouldRedirect = true) => {\n  // 清除所有认证信息\n  localStorage.removeItem('authToken');\n  localStorage.removeItem('userRole');\n  localStorage.removeItem('username');\n  localStorage.removeItem('userId');\n  localStorage.removeItem('email');\n  if (shouldRedirect) {\n    // 跳转到登录页面\n    router.push('/login');\n  }\n};\nexport const handleApiError = (error, options = {}) => {\n  const {\n    customErrorHandler = null,\n    suppressAuthError = false,\n    showAlert = true\n  } = options;\n  console.error('API请求失败:', error);\n  if (error.response) {\n    const status = error.response.status;\n    const message = error.response.data?.message || '操作失败，请重试。';\n    const userRole = localStorage.getItem('userRole');\n\n    // 如果是admin用户且是权限相关错误，显示提示而不是登出\n    if ((status === 401 || status === 403) && userRole === 'admin') {\n      if (showAlert) {\n        alert(status === 403 ? '您没有权限执行此操作' : '您的操作未被授权，请联系超级管理员');\n      }\n      return Promise.reject(error);\n    }\n    switch (status) {\n      case 403:\n      case 401:\n        if (!suppressAuthError) {\n          handleAuthError();\n        } else if (showAlert) {\n          alert('您的登录已过期，请重新登录');\n          router.push('/login');\n        }\n        break;\n      default:\n        if (customErrorHandler) {\n          customErrorHandler(error);\n        } else if (showAlert) {\n          alert(message);\n        }\n    }\n  } else if (error.request) {\n    if (showAlert) {\n      alert('网络错误，请检查您的网络连接。');\n    }\n  } else {\n    if (showAlert) {\n      alert('请求错误，请重试。');\n    }\n  }\n  return Promise.reject(error);\n};","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}