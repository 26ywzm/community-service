{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = {\n  class: \"create-vote\"\n};\nconst _hoisted_2 = {\n  class: \"form-container\"\n};\nconst _hoisted_3 = {\n  class: \"form-item\"\n};\nconst _hoisted_4 = {\n  class: \"form-item\"\n};\nconst _hoisted_5 = {\n  class: \"form-item\"\n};\nconst _hoisted_6 = [\"onUpdate:modelValue\", \"placeholder\"];\nconst _hoisted_7 = [\"onClick\"];\nconst _hoisted_8 = {\n  class: \"form-actions\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_cache[8] || (_cache[8] = _createElementVNode(\"h2\", null, \"创建新投票\", -1 /* HOISTED */)), _createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"div\", _hoisted_3, [_cache[5] || (_cache[5] = _createElementVNode(\"label\", null, \"标题：\", -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.voteForm.title = $event),\n    type: \"text\",\n    placeholder: \"请输入投票标题\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.voteForm.title]])]), _createElementVNode(\"div\", _hoisted_4, [_cache[6] || (_cache[6] = _createElementVNode(\"label\", null, \"描述：\", -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"textarea\", {\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $data.voteForm.description = $event),\n    placeholder: \"请输入投票描述\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.voteForm.description]])]), _createElementVNode(\"div\", _hoisted_5, [_cache[7] || (_cache[7] = _createElementVNode(\"label\", null, \"选项：\", -1 /* HOISTED */)), (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.voteForm.options, (option, index) => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: index,\n      class: \"option-item\"\n    }, [_withDirectives(_createElementVNode(\"input\", {\n      \"onUpdate:modelValue\": $event => $data.voteForm.options[index] = $event,\n      type: \"text\",\n      placeholder: '选项 ' + (index + 1)\n    }, null, 8 /* PROPS */, _hoisted_6), [[_vModelText, $data.voteForm.options[index]]]), index > 1 ? (_openBlock(), _createElementBlock(\"button\", {\n      key: 0,\n      onClick: $event => $options.removeOption(index),\n      class: \"remove-btn\"\n    }, \"删除\", 8 /* PROPS */, _hoisted_7)) : _createCommentVNode(\"v-if\", true)]);\n  }), 128 /* KEYED_FRAGMENT */)), _createElementVNode(\"button\", {\n    onClick: _cache[2] || (_cache[2] = (...args) => $options.addOption && $options.addOption(...args)),\n    class: \"add-btn\"\n  }, \"添加选项\")]), _createElementVNode(\"div\", _hoisted_8, [_createElementVNode(\"button\", {\n    onClick: _cache[3] || (_cache[3] = (...args) => $options.submitVote && $options.submitVote(...args)),\n    class: \"submit-btn\"\n  }, \"创建投票\"), _createElementVNode(\"button\", {\n    onClick: _cache[4] || (_cache[4] = $event => _ctx.$router.push('/adminvotes')),\n    class: \"cancel-btn\"\n  }, \"取消\")])])]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_cache","$event","$data","voteForm","title","type","placeholder","_hoisted_4","description","_hoisted_5","_Fragment","_renderList","options","option","index","key","_hoisted_6","onClick","$options","removeOption","_hoisted_7","_createCommentVNode","args","addOption","_hoisted_8","submitVote","_ctx","$router","push"],"sources":["C:\\Users\\拯救者\\Desktop\\text\\community-service\\src\\components\\CreateVote.vue"],"sourcesContent":["<template>\n  <div class=\"create-vote\">\n    <h2>创建新投票</h2>\n    <div class=\"form-container\">\n      <div class=\"form-item\">\n        <label>标题：</label>\n        <input v-model=\"voteForm.title\" type=\"text\" placeholder=\"请输入投票标题\">\n      </div>\n      <div class=\"form-item\">\n        <label>描述：</label>\n        <textarea v-model=\"voteForm.description\" placeholder=\"请输入投票描述\"></textarea>\n      </div>\n      <div class=\"form-item\">\n        <label>选项：</label>\n        <div v-for=\"(option, index) in voteForm.options\" :key=\"index\" class=\"option-item\">\n          <input v-model=\"voteForm.options[index]\" type=\"text\" :placeholder=\"'选项 ' + (index + 1)\">\n          <button v-if=\"index > 1\" @click=\"removeOption(index)\" class=\"remove-btn\">删除</button>\n        </div>\n        <button @click=\"addOption\" class=\"add-btn\">添加选项</button>\n      </div>\n      <div class=\"form-actions\">\n        <button @click=\"submitVote\" class=\"submit-btn\">创建投票</button>\n        <button @click=\"$router.push('/adminvotes')\" class=\"cancel-btn\">取消</button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport axios from 'axios';\nimport { ElMessage } from 'element-plus';\nimport { adminAuth } from '@/mixins/adminAuth';\nimport 'element-plus/dist/index.css';\n\nconst API = process.env.VUE_APP_BASE_URL;\n\nexport default {\n  name: 'CreateVote',\n  mixins: [adminAuth],\n  data() {\n    return {\n      voteForm: {\n        title: '',\n        description: '',\n        options: ['', ''] // 默认两个选项\n      }\n    };\n  },\n  mounted() {\n    this.checkAdminAuth();\n  },\n  methods: {\n    addOption() {\n      this.voteForm.options.push('');\n    },\n    removeOption(index) {\n      this.voteForm.options.splice(index, 1);\n    },\n    async submitVote() {\n      if (!this.validateForm()) {\n        return;\n      }\n\n      try {\n        await axios.post(`${API}/api/canteen/votes`, this.voteForm, {\n          headers: {\n            'Authorization': `Bearer ${localStorage.getItem('authToken')}`\n          }\n        });\n        ElMessage.success('投票创建成功');\n        this.$router.push('/adminvotes');\n      } catch (error) {\n        console.error('创建投票失败:', error);\n        ElMessage.error('创建投票失败');\n      }\n    },\n    validateForm() {\n      if (!this.voteForm.title.trim()) {\n        ElMessage.warning('请输入投票标题');\n        return false;\n      }\n      if (!this.voteForm.description.trim()) {\n        ElMessage.warning('请输入投票描述');\n        return false;\n      }\n      if (this.voteForm.options.some(option => !option.trim())) {\n        ElMessage.warning('请填写所有选项');\n        return false;\n      }\n      return true;\n    }\n  }\n};\n</script>\n\n<style scoped>\n.create-vote {\n  max-width: 600px;\n  margin: 0 auto;\n  padding: 20px;\n}\n\n.form-container {\n  background: #fff;\n  padding: 20px;\n  border-radius: 8px;\n  box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);\n}\n\n.form-item {\n  margin-bottom: 20px;\n}\n\n.form-item label {\n  display: block;\n  margin-bottom: 8px;\n  font-weight: bold;\n  color: #333;\n}\n\ninput[type=\"text\"], textarea {\n  width: 100%;\n  padding: 8px 12px;\n  border: 1px solid #dcdfe6;\n  border-radius: 4px;\n  margin-bottom: 8px;\n}\n\ntextarea {\n  height: 100px;\n  resize: vertical;\n}\n\n.option-item {\n  display: flex;\n  gap: 10px;\n  margin-bottom: 8px;\n}\n\n.add-btn {\n  background-color: #67c23a;\n  color: white;\n  border: none;\n  padding: 8px 16px;\n  border-radius: 4px;\n  cursor: pointer;\n}\n\n.remove-btn {\n  background-color: #f56c6c;\n  color: white;\n  border: none;\n  padding: 4px 8px;\n  border-radius: 4px;\n  cursor: pointer;\n}\n\n.form-actions {\n  display: flex;\n  gap: 10px;\n  justify-content: flex-end;\n  margin-top: 20px;\n}\n\n.submit-btn {\n  background-color: #409eff;\n  color: white;\n  border: none;\n  padding: 10px 20px;\n  border-radius: 4px;\n  cursor: pointer;\n}\n\n.cancel-btn {\n  background-color: #909399;\n  color: white;\n  border: none;\n  padding: 10px 20px;\n  border-radius: 4px;\n  cursor: pointer;\n}\n\nbutton:hover {\n  opacity: 0.9;\n}\n</style>\n"],"mappings":";;;EACOA,KAAK,EAAC;AAAa;;EAEjBA,KAAK,EAAC;AAAgB;;EACpBA,KAAK,EAAC;AAAW;;EAIjBA,KAAK,EAAC;AAAW;;EAIjBA,KAAK,EAAC;AAAW;mBAZ5B;mBAAA;;EAoBWA,KAAK,EAAC;AAAc;;uBAnB7BC,mBAAA,CAwBM,OAxBNC,UAwBM,G,0BAvBJC,mBAAA,CAAc,YAAV,OAAK,sBACTA,mBAAA,CAqBM,OArBNC,UAqBM,GApBJD,mBAAA,CAGM,OAHNE,UAGM,G,0BAFJF,mBAAA,CAAkB,eAAX,KAAG,sB,gBACVA,mBAAA,CAAkE;IAN1E,uBAAAG,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAMwBC,KAAA,CAAAC,QAAQ,CAACC,KAAK,GAAAH,MAAA;IAAEI,IAAI,EAAC,MAAM;IAACC,WAAW,EAAC;iDAAxCJ,KAAA,CAAAC,QAAQ,CAACC,KAAK,E,KAEhCP,mBAAA,CAGM,OAHNU,UAGM,G,0BAFJV,mBAAA,CAAkB,eAAX,KAAG,sB,gBACVA,mBAAA,CAA0E;IAVlF,uBAAAG,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAU2BC,KAAA,CAAAC,QAAQ,CAACK,WAAW,GAAAP,MAAA;IAAEK,WAAW,EAAC;iDAAlCJ,KAAA,CAAAC,QAAQ,CAACK,WAAW,E,KAEzCX,mBAAA,CAOM,OAPNY,UAOM,G,0BANJZ,mBAAA,CAAkB,eAAX,KAAG,uB,kBACVF,mBAAA,CAGMe,SAAA,QAjBdC,WAAA,CAcuCT,KAAA,CAAAC,QAAQ,CAACS,OAAO,EAdvD,CAcqBC,MAAM,EAAEC,KAAK;yBAA1BnB,mBAAA,CAGM;MAH4CoB,GAAG,EAAED,KAAK;MAAEpB,KAAK,EAAC;wBAClEG,mBAAA,CAAwF;MAflG,uBAAAI,MAAA,IAe0BC,KAAA,CAAAC,QAAQ,CAACS,OAAO,CAACE,KAAK,IAAAb,MAAA;MAAGI,IAAI,EAAC,MAAM;MAAEC,WAAW,WAAWQ,KAAK;4BAf3FE,UAAA,I,cAe0Bd,KAAA,CAAAC,QAAQ,CAACS,OAAO,CAACE,KAAK,G,GACxBA,KAAK,Q,cAAnBnB,mBAAA,CAAoF;MAhB9FoB,GAAA;MAgBoCE,OAAK,EAAAhB,MAAA,IAAEiB,QAAA,CAAAC,YAAY,CAACL,KAAK;MAAGpB,KAAK,EAAC;OAAa,IAAE,iBAhBrF0B,UAAA,KAAAC,mBAAA,e;kCAkBQxB,mBAAA,CAAwD;IAA/CoB,OAAK,EAAAjB,MAAA,QAAAA,MAAA,UAAAsB,IAAA,KAAEJ,QAAA,CAAAK,SAAA,IAAAL,QAAA,CAAAK,SAAA,IAAAD,IAAA,CAAS;IAAE5B,KAAK,EAAC;KAAU,MAAI,E,GAEjDG,mBAAA,CAGM,OAHN2B,UAGM,GAFJ3B,mBAAA,CAA4D;IAAnDoB,OAAK,EAAAjB,MAAA,QAAAA,MAAA,UAAAsB,IAAA,KAAEJ,QAAA,CAAAO,UAAA,IAAAP,QAAA,CAAAO,UAAA,IAAAH,IAAA,CAAU;IAAE5B,KAAK,EAAC;KAAa,MAAI,GACnDG,mBAAA,CAA2E;IAAlEoB,OAAK,EAAAjB,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAAEyB,IAAA,CAAAC,OAAO,CAACC,IAAI;IAAiBlC,KAAK,EAAC;KAAa,IAAE,E","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}