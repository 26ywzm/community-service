{"ast":null,"code":"import { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, vModelText as _vModelText, withDirectives as _withDirectives, withModifiers as _withModifiers, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = {\n  class: \"profile-container\"\n};\nconst _hoisted_2 = {\n  key: 0,\n  class: \"profile-content\"\n};\nconst _hoisted_3 = {\n  class: \"profile-section\"\n};\nconst _hoisted_4 = {\n  class: \"info-group\"\n};\nconst _hoisted_5 = {\n  class: \"info-group\"\n};\nconst _hoisted_6 = {\n  class: \"info-group\"\n};\nconst _hoisted_7 = {\n  class: \"profile-section\"\n};\nconst _hoisted_8 = {\n  class: \"form-group\"\n};\nconst _hoisted_9 = {\n  class: \"form-group\"\n};\nconst _hoisted_10 = {\n  class: \"form-group\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_cache[13] || (_cache[13] = _createElementVNode(\"h2\", null, \"个人资料\", -1 /* HOISTED */)), $data.user ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [_createElementVNode(\"div\", _hoisted_3, [_cache[7] || (_cache[7] = _createElementVNode(\"h3\", null, \"基本信息\", -1 /* HOISTED */)), _createElementVNode(\"div\", _hoisted_4, [_cache[4] || (_cache[4] = _createElementVNode(\"label\", null, \"用户名：\", -1 /* HOISTED */)), _createElementVNode(\"span\", null, _toDisplayString($data.user.username), 1 /* TEXT */)]), _createElementVNode(\"div\", _hoisted_5, [_cache[5] || (_cache[5] = _createElementVNode(\"label\", null, \"邮箱：\", -1 /* HOISTED */)), _createElementVNode(\"span\", null, _toDisplayString($data.user.email), 1 /* TEXT */)]), _createElementVNode(\"div\", _hoisted_6, [_cache[6] || (_cache[6] = _createElementVNode(\"label\", null, \"角色：\", -1 /* HOISTED */)), _createElementVNode(\"span\", null, _toDisplayString($options.formatRole($data.user.role)), 1 /* TEXT */)])]), _createElementVNode(\"div\", _hoisted_7, [_cache[12] || (_cache[12] = _createElementVNode(\"h3\", null, \"修改密码\", -1 /* HOISTED */)), _createElementVNode(\"form\", {\n    onSubmit: _cache[3] || (_cache[3] = _withModifiers((...args) => $options.changePassword && $options.changePassword(...args), [\"prevent\"]))\n  }, [_createElementVNode(\"div\", _hoisted_8, [_cache[8] || (_cache[8] = _createElementVNode(\"label\", null, \"当前密码：\", -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"input\", {\n    type: \"password\",\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.passwordForm.currentPassword = $event),\n    required: \"\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.passwordForm.currentPassword]])]), _createElementVNode(\"div\", _hoisted_9, [_cache[9] || (_cache[9] = _createElementVNode(\"label\", null, \"新密码：\", -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"input\", {\n    type: \"password\",\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $data.passwordForm.newPassword = $event),\n    required: \"\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.passwordForm.newPassword]])]), _createElementVNode(\"div\", _hoisted_10, [_cache[10] || (_cache[10] = _createElementVNode(\"label\", null, \"确认新密码：\", -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"input\", {\n    type: \"password\",\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => $data.passwordForm.confirmPassword = $event),\n    required: \"\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.passwordForm.confirmPassword]])]), _cache[11] || (_cache[11] = _createElementVNode(\"button\", {\n    type: \"submit\",\n    class: \"submit-button\"\n  }, \"修改密码\", -1 /* HOISTED */))], 32 /* NEED_HYDRATION */)])])) : _createCommentVNode(\"v-if\", true)]);\n}","map":{"version":3,"names":["class","key","_createElementBlock","_hoisted_1","_createElementVNode","$data","user","_hoisted_2","_hoisted_3","_hoisted_4","_toDisplayString","username","_hoisted_5","email","_hoisted_6","$options","formatRole","role","_hoisted_7","onSubmit","_cache","_withModifiers","args","changePassword","_hoisted_8","type","$event","passwordForm","currentPassword","required","_hoisted_9","newPassword","_hoisted_10","confirmPassword","_createCommentVNode"],"sources":["C:\\Users\\拯救者\\Desktop\\text\\community-service\\src\\components\\UserProfile.vue"],"sourcesContent":["<template>\n  <div class=\"profile-container\">\n    <h2>个人资料</h2>\n    <div class=\"profile-content\" v-if=\"user\">\n      <div class=\"profile-section\">\n        <h3>基本信息</h3>\n        <div class=\"info-group\">\n          <label>用户名：</label>\n          <span>{{ user.username }}</span>\n        </div>\n        <div class=\"info-group\">\n          <label>邮箱：</label>\n          <span>{{ user.email }}</span>\n        </div>\n        <div class=\"info-group\">\n          <label>角色：</label>\n          <span>{{ formatRole(user.role) }}</span>\n        </div>\n      </div>\n\n      <div class=\"profile-section\">\n        <h3>修改密码</h3>\n        <form @submit.prevent=\"changePassword\">\n          <div class=\"form-group\">\n            <label>当前密码：</label>\n            <input type=\"password\" v-model=\"passwordForm.currentPassword\" required />\n          </div>\n          <div class=\"form-group\">\n            <label>新密码：</label>\n            <input type=\"password\" v-model=\"passwordForm.newPassword\" required />\n          </div>\n          <div class=\"form-group\">\n            <label>确认新密码：</label>\n            <input type=\"password\" v-model=\"passwordForm.confirmPassword\" required />\n          </div>\n          <button type=\"submit\" class=\"submit-button\">修改密码</button>\n        </form>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nconst API = process.env.VUE_APP_API_URL;\nimport axios from 'axios';\n\nexport default {\n  name: 'UserProfile',\n  data() {\n    return {\n      user: null,\n      passwordForm: {\n        currentPassword: '',\n        newPassword: '',\n        confirmPassword: ''\n      }\n    };\n  },\n  async created() {\n    await this.fetchUserProfile();\n  },\n  methods: {\n    formatRole(role) {\n      const roleMap = {\n        'user': '普通用户',\n        'admin': '管理员',\n        'super_admin': '超级管理员'\n      };\n      return roleMap[role] || role;\n    },\n    async fetchUserProfile() {\n      try {\n        const userId = localStorage.getItem('userId');\n        if (!userId) {\n          this.$router.push('/login');\n          return;\n        }\n\n        const response = await axios.get(`${API}/profile`);\n        this.user = response.data.user;\n      } catch (error) {\n        console.error('获取用户资料失败:', error);\n        alert('获取用户资料失败，请重新登录');\n        this.$router.push('/login');\n      }\n    },\n    async changePassword() {\n      try {\n        if (this.passwordForm.newPassword !== this.passwordForm.confirmPassword) {\n          alert('两次输入的新密码不一致');\n          return;\n        }\n\n        await axios.put(`${API}/profile/password`, {\n          currentPassword: this.passwordForm.currentPassword,\n          newPassword: this.passwordForm.newPassword\n        });\n\n        alert('密码修改成功');\n        this.passwordForm = {\n          currentPassword: '',\n          newPassword: '',\n          confirmPassword: ''\n        };\n      } catch (error) {\n        console.error('修改密码失败:', error);\n        alert(error.response?.data?.message || '修改密码失败');\n      }\n    }\n  }\n};\n</script>\n\n<style scoped>\n.profile-container {\n  max-width: 800px;\n  margin: 0 auto;\n  padding: 20px;\n}\n\nh2 {\n  color: #333;\n  text-align: center;\n  margin-bottom: 30px;\n}\n\n.profile-content {\n  display: grid;\n  grid-template-columns: 1fr 1fr;\n  gap: 30px;\n}\n\n.profile-section {\n  background-color: #f5f5f5;\n  padding: 20px;\n  border-radius: 10px;\n}\n\nh3 {\n  color: #444;\n  margin-bottom: 20px;\n  border-bottom: 2px solid #1e90ff;\n  padding-bottom: 10px;\n}\n\n.info-group {\n  margin-bottom: 15px;\n}\n\n.info-group label {\n  color: #666;\n  margin-right: 10px;\n  font-weight: bold;\n}\n\n.form-group {\n  margin-bottom: 15px;\n}\n\n.form-group label {\n  display: block;\n  margin-bottom: 5px;\n  color: #666;\n}\n\ninput {\n  width: 100%;\n  padding: 8px;\n  border: 1px solid #ddd;\n  border-radius: 4px;\n  font-size: 14px;\n}\n\ninput:focus {\n  outline: none;\n  border-color: #1e90ff;\n}\n\n.submit-button {\n  width: 100%;\n  padding: 10px;\n  background-color: #1e90ff;\n  color: white;\n  border: none;\n  border-radius: 4px;\n  cursor: pointer;\n  font-size: 16px;\n  margin-top: 10px;\n}\n\n.submit-button:hover {\n  background-color: #187bcd;\n}\n\n@media (max-width: 768px) {\n  .profile-content {\n    grid-template-columns: 1fr;\n  }\n}\n</style>\n"],"mappings":";;EACOA,KAAK,EAAC;AAAmB;;EADhCC,GAAA;EAGSD,KAAK,EAAC;;;EACJA,KAAK,EAAC;AAAiB;;EAErBA,KAAK,EAAC;AAAY;;EAIlBA,KAAK,EAAC;AAAY;;EAIlBA,KAAK,EAAC;AAAY;;EAMpBA,KAAK,EAAC;AAAiB;;EAGnBA,KAAK,EAAC;AAAY;;EAIlBA,KAAK,EAAC;AAAY;;EAIlBA,KAAK,EAAC;AAAY;;uBA9B/BE,mBAAA,CAsCM,OAtCNC,UAsCM,G,4BArCJC,mBAAA,CAAa,YAAT,MAAI,sBAC2BC,KAAA,CAAAC,IAAI,I,cAAvCJ,mBAAA,CAmCM,OAnCNK,UAmCM,GAlCJH,mBAAA,CAcM,OAdNI,UAcM,G,0BAbJJ,mBAAA,CAAa,YAAT,MAAI,sBACRA,mBAAA,CAGM,OAHNK,UAGM,G,0BAFJL,mBAAA,CAAmB,eAAZ,MAAI,sBACXA,mBAAA,CAAgC,cAAAM,gBAAA,CAAvBL,KAAA,CAAAC,IAAI,CAACK,QAAQ,iB,GAExBP,mBAAA,CAGM,OAHNQ,UAGM,G,0BAFJR,mBAAA,CAAkB,eAAX,KAAG,sBACVA,mBAAA,CAA6B,cAAAM,gBAAA,CAApBL,KAAA,CAAAC,IAAI,CAACO,KAAK,iB,GAErBT,mBAAA,CAGM,OAHNU,UAGM,G,0BAFJV,mBAAA,CAAkB,eAAX,KAAG,sBACVA,mBAAA,CAAwC,cAAAM,gBAAA,CAA/BK,QAAA,CAAAC,UAAU,CAACX,KAAA,CAAAC,IAAI,CAACW,IAAI,kB,KAIjCb,mBAAA,CAiBM,OAjBNc,UAiBM,G,4BAhBJd,mBAAA,CAAa,YAAT,MAAI,sBACRA,mBAAA,CAcO;IAdAe,QAAM,EAAAC,MAAA,QAAAA,MAAA,MAtBrBC,cAAA,KAAAC,IAAA,KAsB+BP,QAAA,CAAAQ,cAAA,IAAAR,QAAA,CAAAQ,cAAA,IAAAD,IAAA,CAAc;MACnClB,mBAAA,CAGM,OAHNoB,UAGM,G,0BAFJpB,mBAAA,CAAoB,eAAb,OAAK,sB,gBACZA,mBAAA,CAAyE;IAAlEqB,IAAI,EAAC,UAAU;IAzBlC,uBAAAL,MAAA,QAAAA,MAAA,MAAAM,MAAA,IAyB4CrB,KAAA,CAAAsB,YAAY,CAACC,eAAe,GAAAF,MAAA;IAAEG,QAAQ,EAAR;iDAA9BxB,KAAA,CAAAsB,YAAY,CAACC,eAAe,E,KAE9DxB,mBAAA,CAGM,OAHN0B,UAGM,G,0BAFJ1B,mBAAA,CAAmB,eAAZ,MAAI,sB,gBACXA,mBAAA,CAAqE;IAA9DqB,IAAI,EAAC,UAAU;IA7BlC,uBAAAL,MAAA,QAAAA,MAAA,MAAAM,MAAA,IA6B4CrB,KAAA,CAAAsB,YAAY,CAACI,WAAW,GAAAL,MAAA;IAAEG,QAAQ,EAAR;iDAA1BxB,KAAA,CAAAsB,YAAY,CAACI,WAAW,E,KAE1D3B,mBAAA,CAGM,OAHN4B,WAGM,G,4BAFJ5B,mBAAA,CAAqB,eAAd,QAAM,sB,gBACbA,mBAAA,CAAyE;IAAlEqB,IAAI,EAAC,UAAU;IAjClC,uBAAAL,MAAA,QAAAA,MAAA,MAAAM,MAAA,IAiC4CrB,KAAA,CAAAsB,YAAY,CAACM,eAAe,GAAAP,MAAA;IAAEG,QAAQ,EAAR;iDAA9BxB,KAAA,CAAAsB,YAAY,CAACM,eAAe,E,iCAE9D7B,mBAAA,CAAyD;IAAjDqB,IAAI,EAAC,QAAQ;IAACzB,KAAK,EAAC;KAAgB,MAAI,qB,kCAnC1DkC,mBAAA,e","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}